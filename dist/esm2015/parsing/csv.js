export function parseCSV(txt, options) {
    let columns = options && options.columns;
    let lines = txt.split('\n');
    if (!columns) {
        let header = lines[0];
        lines = lines.slice(1);
        columns = header.split(',');
    }
    return lines.filter(ln => ln.length).map(ln => {
        let data = ln.split(',');
        let result = {};
        data.forEach((val, i) => {
            result[columns[i]] = parseVal(val);
        });
        return result;
    });
}
function parseVal(val) {
    // Try date...
    let components = val.split('-');
    if (components.length === 3) {
        let dateComponents = components.map(c => +c);
        if (!dateComponents.some(isNaN)) {
            return new Date(Date.UTC(dateComponents[0], dateComponents[1] - 1, dateComponents[2]));
        }
    }
    if (val === '') {
        return val;
    }
    // Try numeric
    let numeric = +val;
    if (!isNaN(numeric)) {
        return numeric;
    }
    return val;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY3N2LmpzIiwic291cmNlUm9vdCI6Ii4uLy4uL3NyYy8iLCJzb3VyY2VzIjpbInBhcnNpbmcvY3N2LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQVNBLE1BQU0sVUFBVSxRQUFRLENBQUMsR0FBVSxFQUFDLE9BQXlCO0lBQzNELElBQUksT0FBTyxHQUFHLE9BQU8sSUFBRSxPQUFPLENBQUMsT0FBTyxDQUFDO0lBQ3ZDLElBQUksS0FBSyxHQUFHLEdBQUcsQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDNUIsSUFBRyxDQUFDLE9BQU8sRUFBQztRQUNWLElBQUksTUFBTSxHQUFHLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUN0QixLQUFLLEdBQUcsS0FBSyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUN2QixPQUFPLEdBQUcsTUFBTSxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQztLQUM3QjtJQUVELE9BQU8sS0FBSyxDQUFDLE1BQU0sQ0FBQyxFQUFFLENBQUEsRUFBRSxDQUFBLEVBQUUsQ0FBQyxNQUFNLENBQUMsQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFBLEVBQUU7UUFDekMsSUFBSSxJQUFJLEdBQUcsRUFBRSxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQztRQUV6QixJQUFJLE1BQU0sR0FBWSxFQUFFLENBQUM7UUFDekIsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDLEdBQUcsRUFBQyxDQUFDLEVBQUMsRUFBRTtZQUNwQixNQUFNLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsUUFBUSxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBQ3JDLENBQUMsQ0FBQyxDQUFDO1FBQ0gsT0FBTyxNQUFNLENBQUM7SUFDaEIsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDO0FBRUQsU0FBUyxRQUFRLENBQUMsR0FBVTtJQUUxQixjQUFjO0lBQ2QsSUFBSSxVQUFVLEdBQUcsR0FBRyxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQztJQUNoQyxJQUFHLFVBQVUsQ0FBQyxNQUFNLEtBQUcsQ0FBQyxFQUFDO1FBQ3ZCLElBQUksY0FBYyxHQUFHLFVBQVUsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFBLEVBQUUsQ0FBQSxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQzNDLElBQUcsQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxFQUFDO1lBQzdCLE9BQU8sSUFBSSxJQUFJLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxjQUFjLENBQUMsQ0FBQyxDQUFDLEVBQUMsY0FBYyxDQUFDLENBQUMsQ0FBQyxHQUFDLENBQUMsRUFBQyxjQUFjLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1NBQ3BGO0tBQ0Y7SUFFRCxJQUFHLEdBQUcsS0FBRyxFQUFFLEVBQUM7UUFDVixPQUFPLEdBQUcsQ0FBQztLQUNaO0lBRUQsY0FBYztJQUNkLElBQUksT0FBTyxHQUFVLENBQUMsR0FBRyxDQUFDO0lBQzFCLElBQUcsQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLEVBQUM7UUFDakIsT0FBTyxPQUFPLENBQUM7S0FDaEI7SUFFRCxPQUFPLEdBQUcsQ0FBQztBQUNiLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJcbmV4cG9ydCBpbnRlcmZhY2UgVGFibGVSb3d7XG4gIFtrZXk6c3RyaW5nXTphbnk7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ3N2UGFyc2VyT3B0aW9ucyB7XG4gIGNvbHVtbnM/OiBzdHJpbmdbXTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHBhcnNlQ1NWKHR4dDpzdHJpbmcsb3B0aW9ucz86Q3N2UGFyc2VyT3B0aW9ucyk6VGFibGVSb3dbXXtcbiAgbGV0IGNvbHVtbnMgPSBvcHRpb25zJiZvcHRpb25zLmNvbHVtbnM7XG4gIGxldCBsaW5lcyA9IHR4dC5zcGxpdCgnXFxuJyk7XG4gIGlmKCFjb2x1bW5zKXtcbiAgICBsZXQgaGVhZGVyID0gbGluZXNbMF07XG4gICAgbGluZXMgPSBsaW5lcy5zbGljZSgxKTtcbiAgICBjb2x1bW5zID0gaGVhZGVyLnNwbGl0KCcsJyk7XG4gIH1cblxuICByZXR1cm4gbGluZXMuZmlsdGVyKGxuPT5sbi5sZW5ndGgpLm1hcChsbj0+e1xuICAgIGxldCBkYXRhID0gbG4uc3BsaXQoJywnKTtcblxuICAgIGxldCByZXN1bHQ6VGFibGVSb3cgPSB7fTtcbiAgICBkYXRhLmZvckVhY2goKHZhbCxpKT0+e1xuICAgICAgcmVzdWx0W2NvbHVtbnNbaV1dID0gcGFyc2VWYWwodmFsKTtcbiAgICB9KTtcbiAgICByZXR1cm4gcmVzdWx0O1xuICB9KTtcbn1cblxuZnVuY3Rpb24gcGFyc2VWYWwodmFsOnN0cmluZyk6YW55e1xuXG4gIC8vIFRyeSBkYXRlLi4uXG4gIGxldCBjb21wb25lbnRzID0gdmFsLnNwbGl0KCctJyk7XG4gIGlmKGNvbXBvbmVudHMubGVuZ3RoPT09Myl7XG4gICAgbGV0IGRhdGVDb21wb25lbnRzID0gY29tcG9uZW50cy5tYXAoYz0+K2MpO1xuICAgIGlmKCFkYXRlQ29tcG9uZW50cy5zb21lKGlzTmFOKSl7XG4gICAgICByZXR1cm4gbmV3IERhdGUoRGF0ZS5VVEMoZGF0ZUNvbXBvbmVudHNbMF0sZGF0ZUNvbXBvbmVudHNbMV0tMSxkYXRlQ29tcG9uZW50c1syXSkpO1xuICAgIH1cbiAgfVxuXG4gIGlmKHZhbD09PScnKXtcbiAgICByZXR1cm4gdmFsO1xuICB9XG5cbiAgLy8gVHJ5IG51bWVyaWNcbiAgbGV0IG51bWVyaWM6bnVtYmVyID0gK3ZhbDtcbiAgaWYoIWlzTmFOKG51bWVyaWMpKXtcbiAgICByZXR1cm4gbnVtZXJpYztcbiAgfVxuXG4gIHJldHVybiB2YWw7XG59XG4iXX0=