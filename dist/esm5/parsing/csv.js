export function parseCSV(txt, options) {
    var columns = options && options.columns;
    var lines = txt.split('\n');
    if (!columns) {
        var header = lines[0];
        lines = lines.slice(1);
        columns = header.split(',');
    }
    return lines.filter(function (ln) { return ln.length; }).map(function (ln) {
        var data = ln.split(',');
        var result = {};
        data.forEach(function (val, i) {
            result[columns[i]] = parseVal(val);
        });
        return result;
    });
}
function parseVal(val) {
    // Try date...
    var components = val.split('-');
    if (components.length === 3) {
        var dateComponents = components.map(function (c) { return +c; });
        if (!dateComponents.some(isNaN)) {
            return new Date(Date.UTC(dateComponents[0], dateComponents[1] - 1, dateComponents[2]));
        }
    }
    if (val === '') {
        return val;
    }
    // Try numeric
    var numeric = +val;
    if (!isNaN(numeric)) {
        return numeric;
    }
    return val;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY3N2LmpzIiwic291cmNlUm9vdCI6Im5nOi8vbWFwLXdhbGQvIiwic291cmNlcyI6WyJwYXJzaW5nL2Nzdi50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFTQSxNQUFNLFVBQVUsUUFBUSxDQUFDLEdBQVUsRUFBQyxPQUF5QjtJQUMzRCxJQUFJLE9BQU8sR0FBRyxPQUFPLElBQUUsT0FBTyxDQUFDLE9BQU8sQ0FBQztJQUN2QyxJQUFJLEtBQUssR0FBRyxHQUFHLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQzVCLElBQUcsQ0FBQyxPQUFPLEVBQUM7UUFDVixJQUFJLE1BQU0sR0FBRyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDdEIsS0FBSyxHQUFHLEtBQUssQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDdkIsT0FBTyxHQUFHLE1BQU0sQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUM7S0FDN0I7SUFFRCxPQUFPLEtBQUssQ0FBQyxNQUFNLENBQUMsVUFBQSxFQUFFLElBQUUsT0FBQSxFQUFFLENBQUMsTUFBTSxFQUFULENBQVMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxVQUFBLEVBQUU7UUFDdkMsSUFBSSxJQUFJLEdBQUcsRUFBRSxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQztRQUV6QixJQUFJLE1BQU0sR0FBWSxFQUFFLENBQUM7UUFDekIsSUFBSSxDQUFDLE9BQU8sQ0FBQyxVQUFDLEdBQUcsRUFBQyxDQUFDO1lBQ2pCLE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxRQUFRLENBQUMsR0FBRyxDQUFDLENBQUM7UUFDckMsQ0FBQyxDQUFDLENBQUM7UUFDSCxPQUFPLE1BQU0sQ0FBQztJQUNoQixDQUFDLENBQUMsQ0FBQztBQUNMLENBQUM7QUFFRCxTQUFTLFFBQVEsQ0FBQyxHQUFVO0lBRTFCLGNBQWM7SUFDZCxJQUFJLFVBQVUsR0FBRyxHQUFHLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDO0lBQ2hDLElBQUcsVUFBVSxDQUFDLE1BQU0sS0FBRyxDQUFDLEVBQUM7UUFDdkIsSUFBSSxjQUFjLEdBQUcsVUFBVSxDQUFDLEdBQUcsQ0FBQyxVQUFBLENBQUMsSUFBRSxPQUFBLENBQUMsQ0FBQyxFQUFGLENBQUUsQ0FBQyxDQUFDO1FBQzNDLElBQUcsQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxFQUFDO1lBQzdCLE9BQU8sSUFBSSxJQUFJLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxjQUFjLENBQUMsQ0FBQyxDQUFDLEVBQUMsY0FBYyxDQUFDLENBQUMsQ0FBQyxHQUFDLENBQUMsRUFBQyxjQUFjLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1NBQ3BGO0tBQ0Y7SUFFRCxJQUFHLEdBQUcsS0FBRyxFQUFFLEVBQUM7UUFDVixPQUFPLEdBQUcsQ0FBQztLQUNaO0lBRUQsY0FBYztJQUNkLElBQUksT0FBTyxHQUFVLENBQUMsR0FBRyxDQUFDO0lBQzFCLElBQUcsQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLEVBQUM7UUFDakIsT0FBTyxPQUFPLENBQUM7S0FDaEI7SUFFRCxPQUFPLEdBQUcsQ0FBQztBQUNiLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJcbmV4cG9ydCBpbnRlcmZhY2UgVGFibGVSb3d7XG4gIFtrZXk6c3RyaW5nXTphbnk7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ3N2UGFyc2VyT3B0aW9ucyB7XG4gIGNvbHVtbnM/OiBzdHJpbmdbXTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHBhcnNlQ1NWKHR4dDpzdHJpbmcsb3B0aW9ucz86Q3N2UGFyc2VyT3B0aW9ucyk6VGFibGVSb3dbXXtcbiAgbGV0IGNvbHVtbnMgPSBvcHRpb25zJiZvcHRpb25zLmNvbHVtbnM7XG4gIGxldCBsaW5lcyA9IHR4dC5zcGxpdCgnXFxuJyk7XG4gIGlmKCFjb2x1bW5zKXtcbiAgICBsZXQgaGVhZGVyID0gbGluZXNbMF07XG4gICAgbGluZXMgPSBsaW5lcy5zbGljZSgxKTtcbiAgICBjb2x1bW5zID0gaGVhZGVyLnNwbGl0KCcsJyk7XG4gIH1cblxuICByZXR1cm4gbGluZXMuZmlsdGVyKGxuPT5sbi5sZW5ndGgpLm1hcChsbj0+e1xuICAgIGxldCBkYXRhID0gbG4uc3BsaXQoJywnKTtcblxuICAgIGxldCByZXN1bHQ6VGFibGVSb3cgPSB7fTtcbiAgICBkYXRhLmZvckVhY2goKHZhbCxpKT0+e1xuICAgICAgcmVzdWx0W2NvbHVtbnNbaV1dID0gcGFyc2VWYWwodmFsKTtcbiAgICB9KTtcbiAgICByZXR1cm4gcmVzdWx0O1xuICB9KTtcbn1cblxuZnVuY3Rpb24gcGFyc2VWYWwodmFsOnN0cmluZyk6YW55e1xuXG4gIC8vIFRyeSBkYXRlLi4uXG4gIGxldCBjb21wb25lbnRzID0gdmFsLnNwbGl0KCctJyk7XG4gIGlmKGNvbXBvbmVudHMubGVuZ3RoPT09Myl7XG4gICAgbGV0IGRhdGVDb21wb25lbnRzID0gY29tcG9uZW50cy5tYXAoYz0+K2MpO1xuICAgIGlmKCFkYXRlQ29tcG9uZW50cy5zb21lKGlzTmFOKSl7XG4gICAgICByZXR1cm4gbmV3IERhdGUoRGF0ZS5VVEMoZGF0ZUNvbXBvbmVudHNbMF0sZGF0ZUNvbXBvbmVudHNbMV0tMSxkYXRlQ29tcG9uZW50c1syXSkpO1xuICAgIH1cbiAgfVxuXG4gIGlmKHZhbD09PScnKXtcbiAgICByZXR1cm4gdmFsO1xuICB9XG5cbiAgLy8gVHJ5IG51bWVyaWNcbiAgbGV0IG51bWVyaWM6bnVtYmVyID0gK3ZhbDtcbiAgaWYoIWlzTmFOKG51bWVyaWMpKXtcbiAgICByZXR1cm4gbnVtZXJpYztcbiAgfVxuXG4gIHJldHVybiB2YWw7XG59XG4iXX0=